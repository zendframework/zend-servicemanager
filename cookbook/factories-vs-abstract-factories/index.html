<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="zend-servicemanager: factory-driven dependency injection container">  
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Factories vs Abstract Factories - zend-servicemanager</title>

    <link rel="stylesheet" href="../../css/styles-e95dab66f8.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-servicemanager</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../.." class="subnavigation__link">zend-servicemanager</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../quick-start/" class="subnavigation__link">Quick Start</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../psr-11/" class="subnavigation__link">PSR-11 Support</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../configuring-the-service-manager/" class="subnavigation__link">Configuring the service manager</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../delegators/" class="subnavigation__link">Delegators</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../lazy-services/" class="subnavigation__link">Lazy services</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../plugin-managers/" class="subnavigation__link">Plugin managers</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../config-abstract-factory/" class="subnavigation__link">Configuration-based Abstract Factory</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../reflection-abstract-factory/" class="subnavigation__link">Reflection-based Abstract Factory</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../console-tools/" class="subnavigation__link">Console Tools</a>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Cookbook</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Factories vs Abstract Factories</a>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../migration/" class="subnavigation__link">Migration Guide</a>
                    </li>
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-servicemanager</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-servicemanager/" class="header__link header__link--github" title="Go to repository of zend-servicemanager">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
    <li><a href="https://framework.zend.com/">Home</a></li>

    
        <li><a href="https://docs.zendframework.com/">Documentation</a></li>

        
            <li><a href="../..">zend-servicemanager</a></li>

            
                
                    <li>Cookbook</li>
                
            

            <li class="active">Factories vs Abstract Factories</li>
        
    
</ol>


    
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#comparisons" class="toc__link">Comparisons</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#convenience" class="toc__link">Convenience</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#explicitness" class="toc__link">Explicitness</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#tradeoffs" class="toc__link">Tradeoffs</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#tooling" class="toc__link">Tooling</a>
                    </li>
                
            </ul>
        </div>
    


    <h1 id="when-to-use-factories-vs-abstract-factories">When To Use Factories vs Abstract Factories</h1>
<p>Starting with version 3, <code>Zend\ServiceManager\Factory\AbstractFactoryInterface</code>
extends <code>Zend\ServiceManager\Factory\FactoryInterface</code>, meaning they may be used
as either an abstract factory, or mapped to a specific service name as its
factory.</p>
<p>As an example:</p>
<pre class="codehilite"><code class="language-php">return [
    'factories' =&gt; [
        SomeService::class =&gt; AnAbstractFactory::class,
    ],
];</code></pre>

<p>Why would you choose one approach over the other?</p>
<h2 id="comparisons">Comparisons</h2>
<div class="table-responsive"><table>
<thead>
<tr>
<th>Approach</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td>Abstract factory</td>
<td>One-time setup</td>
<td>Performance; discovery of code responsible for creating instance</td>
</tr>
<tr>
<td>Factory</td>
<td>Performance; explicit mapping to factory responsible</td>
<td>Additional (duplicate) setup</td>
</tr>
</tbody>
</table></div>
<p>Essentially, it comes down to <em>convenience</em> versus <em>explicitness</em> and/or
<em>performance</em>.</p>
<h2 id="convenience">Convenience</h2>
<p>Writing a factory per service is time consuming, and, particularly in early
stages of an application, can distract from the actual business of writing the
classes and implementations; in addition, since requirements are often changing
regularly, this boiler-plate code can be a nuisance.</p>
<p>In such situations, one or more abstract factories &mdash; such as the
<a href="../../config-abstract-factory/">ConfigAbstractFactory</a>, the
<a href="../../reflection-abstract-factory/">ReflectionBasedAbstractFactory</a>, or the
<a href="https://docs.zendframework.com/zend-mvc/cookbook/automating-controller-factories/">zend-mvc LazyControllerAbstractFactory</a>
&mdash; that can handle the bulk of your needs are often worthwhile, saving you
time and effort as you code.</p>
<h2 id="explicitness">Explicitness</h2>
<p>The drawback of abstract factories is that lookups by the service manager take
longer, and increase based on the number of abstract factories in the system.
The service manager is optimized to locate <em>factories</em>, as it can do an
immediate hash table lookup; abstract factories involve:</p>
<ul>
<li>Looping through each abstract factory<ul>
<li>invoking its method for service location</li>
<li>if the service is located, using the factory</li>
</ul>
</li>
</ul>
<p>This means, internally:</p>
<ul>
<li>a hash table lookup (for the abstract factory)</li>
<li>invocation of 1:N methods for discovery<ul>
<li>which may contain additional lookups and/or retrievals in the container</li>
</ul>
</li>
<li>invocation of a factory method (assuming succesful lookup)</li>
</ul>
<p>As such, having an explicit map can aid performance dramatically.</p>
<p>Additionally, having an explicit map can aid in understanding what class is
responsible for initializing a given service. Without an explicit map, you need
to identify all possible abstract factories, and determine which one is capable
of handling the specific service; in some cases, multiple factories might be
able to, which means you additionally need to know the <em>order</em> in which they
will be queried.</p>
<p>The primary drawback is that you also end up with potentially duplicate
information in your configuration:</p>
<ul>
<li>Multiple services mapped to the same factory.</li>
<li>In cases such as the <code>ConfigAbstractFactory</code>, additional configuration
  detailing how to create the service.</li>
</ul>
<h2 id="tradeoffs">Tradeoffs</h2>
<p>What it comes down to is which development aspects your organization or project
favor. Hopefully the above arguments detail what tradeoffs occur, so you may
make an appropriate choice.</p>
<h2 id="tooling">Tooling</h2>
<p>Starting with 3.2.0, we began offering a variety of <a href="../../console-tools/">console tools</a>
to assist you in generating both dependency configuration and factories. Use
these to help your code evolve. An expected workflow in your application
development evolution is:</p>
<ul>
<li>Usage of the <code>ReflectionBasedAbstractFactory</code> as a "catch-all", so that you
  do not need to do any factory/dependency configuration immediately.</li>
<li>Usage of the <code>ConfigAbstractFactory</code>, mapped to services, once dependencies
  have settled, to disambiguate dependencies, or to list custom services
  returning scalar or array values.</li>
<li>Finally, usage of the <code>generate-factory-for-class</code> vendor binary to generate
  actual factory classes for your production-ready code, providing the best
  performance.</li>
</ul>



    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../../console-tools/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../../migration/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>



    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-servicemanager/edit/master/docs/book/cookbook/factories-vs-abstract-factories.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentation…</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-servicemanager</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../.." class="subnavigation__link">zend-servicemanager</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../quick-start/" class="subnavigation__link">Quick Start</a>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Reference</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../psr-11/" class="subnavigation__link">PSR-11 Support</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../configuring-the-service-manager/" class="subnavigation__link">Configuring the service manager</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../delegators/" class="subnavigation__link">Delegators</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../lazy-services/" class="subnavigation__link">Lazy services</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../plugin-managers/" class="subnavigation__link">Plugin managers</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../config-abstract-factory/" class="subnavigation__link">Configuration-based Abstract Factory</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../reflection-abstract-factory/" class="subnavigation__link">Reflection-based Abstract Factory</a>
    </li>

                            
                                
    <li class="subnavigation__list-item ">
        <a href="../../console-tools/" class="subnavigation__link">Console Tools</a>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item">
                        <span class="subnavigation__headline">Cookbook</span>
                        <ul class="subnavigation__list">
                            
                                
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">Factories vs Abstract Factories</a>
    </li>

                            
                        </ul>
                    </li>
                
            
                
                    <li class="subnavigation__list-item ">
                        <a href="../../migration/" class="subnavigation__link">Migration Guide</a>
                    </li>
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2018 by <a href="https://www.zend.com/">Zend</a>, a <a href="https://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.zendframework.com" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://zendframework-slack.herokuapp.com" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://tinyletter.com/mwopzend" class="support__link" title="Newsletter"><i class="fa fa-envelope"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/blog/feed-rss.xml" class="support__link" title="Blog feed"><i class="fa fa-rss"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://framework.zend.com/security/feed" class="support__link" title="Security feed"><i class="fa fa-rss-square"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <script>
        var base_url = '../..',
            siteName = 'zend-servicemanager';
    </script>
    <script src="../../js/scripts-a978f1ec1a.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
